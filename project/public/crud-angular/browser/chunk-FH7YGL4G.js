import{a as it}from"./chunk-BNF7E4AS.js";import"./chunk-MS4AQ6UA.js";import{$ as J,A as Et,B as yt,C as It,D as Dt,E as Rt,F as Ft,H as At,I as Vt,J as jt,K as Gt,L as Nt,M as z,N as Ot,O as H,P as Pt,Q as $t,R as Bt,S as Ut,T as q,U as zt,V as g,W as k,X as L,Y as Ht,Z as qt,_ as Q,c as E,d as y,e as I,f as pt,g as dt,h as ut,i as ft,j as kt,k as vt,l as _t,m as ht,n as Ct,o as gt,p as St,q as Tt,r as bt,s as Mt,t as $,u as xt,v as B,x as wt,z as U}from"./chunk-24ZQDHAV.js";import"./chunk-JORF2XPE.js";import{$a as ct,Aa as f,Fa as D,Ha as at,Ia as mt,Ib as x,J as N,Ja as r,K as rt,Ka as o,Kb as w,La as h,Lb as st,M as S,Ma as b,Na as M,Ob as et,Pa as R,Ra as d,S as v,Sa as C,T as _,Wa as Y,Xa as Z,Ya as tt,ab as n,bb as O,cb as u,hb as P,ja as m,k as j,na as l,ra as T,sa as nt,v as G,wa as s,zb as lt}from"./chunk-47BL5O6Z.js";var Zt=()=>[5,10,25,100];function te(e,t){e&1&&(r(0,"th",17),n(1," ID "),o())}function ee(e,t){if(e&1&&(r(0,"td",18),n(1),o()),e&2){let i=t.$implicit;m(),u(" ",i.id," ")}}function ie(e,t){e&1&&(r(0,"th",19),n(1,"Titre"),o())}function oe(e,t){if(e&1&&(r(0,"td",18),n(1),o()),e&2){let i=t.$implicit;m(),O(i.titre)}}function re(e,t){e&1&&(r(0,"th",19),n(1,"Description"),o())}function ne(e,t){if(e&1&&(r(0,"td",18),n(1),o()),e&2){let i=t.$implicit;m(),O(i.description)}}function ae(e,t){e&1&&(r(0,"th",19),n(1,"Sale"),o())}function me(e,t){if(e&1&&(r(0,"td",18),n(1),o()),e&2){let i=t.$implicit;m(),O(i.sales[0].titre)}}function ce(e,t){e&1&&(r(0,"th",19),n(1,"Actions"),o())}function le(e,t){if(e&1){let i=R();r(0,"td",18)(1,"button",20),d("click",function(){let c=v(i).$implicit,p=C();return _(p.viewTicket(c))}),n(2,"Voir"),o(),r(3,"button",20),d("click",function(){let c=v(i).$implicit,p=C();return _(p.editTicket(c))}),n(4,"Modifier"),o(),r(5,"button",21),d("click",function(){let c=v(i).$implicit,p=C();return _(p.deleteTicket(c))}),n(6,"Supprimer"),o()()}}function se(e,t){e&1&&h(0,"tr",22)}function pe(e,t){e&1&&h(0,"tr",23)}function de(e,t){if(e&1&&(r(0,"tr",24)(1,"td",25),n(2),o()()),e&2){C();let i=ct(7);m(2),u('No data matching the filter "',i.value,'"')}}var K=class e{constructor(t,i,a,c,p){this.genericService=t;this.genericServiceSale=i;this.dialog=a;this.router=c;this.activatedRoute=p}tickets=[];displayedColumns=["id","titre","description","sales","actions"];dataSource=new Mt;baseUri=g.baseUri;paginator;sort;ngOnInit(){this.activatedRoute.data.subscribe(t=>{this.tickets=t.tickets,this.dataSource.data=t.tickets})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}applyFilter(t){let i=t.target.value;this.dataSource.filter=i.trim().toLowerCase()}loadTickets(){this.genericService.getAll(`${this.baseUri}/api/ticket`).subscribe(t=>{this.tickets=t})}viewTicket(t){this.router.navigate(["/ticket/show",t.id]).then()}editTicket(t){this.router.navigate(["/ticket/edit",t.id]).then()}deleteTicket(t){this.dialog.open(pt,{data:{message:"Voulez-vous vraiment supprimer ce ticket ?"}}).afterClosed().subscribe(a=>{a&&this.genericService.delete(`${this.baseUri}/api/ticket`,t.id).subscribe(()=>{this.loadTickets()})})}goToAddSale(){this.router.navigate(["/ticket/add"]).then()}static \u0275fac=function(i){return new(i||e)(l(k),l(k),l(I),l(w),l(x))};static \u0275cmp=T({type:e,selectors:[["app-ticket"]],viewQuery:function(i,a){if(i&1&&(Y(z,5),Y(H,5)),i&2){let c;Z(c=tt())&&(a.paginator=c.first),Z(c=tt())&&(a.sort=c.first)}},decls:32,vars:5,consts:[["input",""],["matInput","","placeholder","Ex. Mia",3,"keyup"],["mat-raised-button","","color","primary","id","btnAjout",3,"click"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","titre"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","description"],["matColumnDef","sales"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-button","",3,"click"],["mat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(i,a){if(i&1){let c=R();r(0,"table")(1,"tr")(2,"td")(3,"mat-form-field")(4,"mat-label"),n(5,"Filter"),o(),r(6,"input",1,0),d("keyup",function(Xt){return v(c),_(a.applyFilter(Xt))}),o()()(),r(8,"td")(9,"button",2),d("click",function(){return v(c),_(a.goToAddSale())}),n(10,"Ajouter Ticket"),o()()()(),r(11,"div",3)(12,"table",4),b(13,5),s(14,te,2,0,"th",6)(15,ee,2,1,"td",7),M(),b(16,8),s(17,ie,2,0,"th",9)(18,oe,2,1,"td",7),M(),b(19,10),s(20,re,2,0,"th",9)(21,ne,2,1,"td",7),M(),b(22,11),s(23,ae,2,0,"th",9)(24,me,2,1,"td",7),M(),b(25,12),s(26,ce,2,0,"th",9)(27,le,7,0,"td",7),M(),s(28,se,1,0,"tr",13)(29,pe,1,0,"tr",14)(30,de,3,1,"tr",15),o(),h(31,"mat-paginator",16),o()}i&2&&(m(12),f("dataSource",a.dataSource),m(16),f("matHeaderRowDef",a.displayedColumns),m(),f("matRowDefColumns",a.displayedColumns),m(2),f("pageSizeOptions",P(4,Zt)))},dependencies:[bt,dt,ft,ht,kt,ut,Ct,vt,_t,gt,St,Tt,y,E,$t,H,Pt,Ot,z,zt,q,B,$],styles:["table[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}#btnAjout[_ngcontent-%COMP%]{margin-bottom:30px}"]})};var A=class e{constructor(t,i){this.ticket=t;this.dialog=i}baseUri=g.baseUri;resolve(t){return this.ticket.getById(`${this.baseUri}/api/ticket`,t.params.id).pipe(G(i=>(this.showErrorDialog(i.message),j("No data"))))}showErrorDialog(t){this.dialog.open(L,{width:"300px",data:{message:t}})}static \u0275fac=function(i){return new(i||e)(S(k),S(I))};static \u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"})};var W=class e{constructor(t,i){this.ticket=t;this.dialog=i}baseUri=g.baseUri;resolve(){return this.ticket.getAll(`${this.baseUri}/api/ticket`).pipe(G(t=>(this.showErrorDialog(t.message),j("No data"))))}showErrorDialog(t){this.dialog.open(L,{width:"300px",data:{message:t}})}static \u0275fac=function(i){return new(i||e)(S(k),S(I))};static \u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"})};var fe=()=>["/ticket"],ke=(e,t)=>t.id;function ve(e,t){if(e&1&&(r(0,"mat-option",11),n(1),o()),e&2){let i=t.$implicit;f("value",i.id),m(),u(" ",i.titre," ")}}function _e(e,t){e&1&&(r(0,"mat-error"),n(1," La s\xE9lection d'une vente est requise "),o())}function he(e,t){if(e&1&&(r(0,"mat-form-field",6)(1,"mat-label"),n(2,"Ventes"),o(),r(3,"mat-select",10),at(4,ve,2,2,"mat-option",11,ke),o(),s(6,_e,2,0,"mat-error"),o()),e&2){let i,a=C();m(4),mt(a.sales),m(2),D((i=a.ticketForm.get("sale_id"))!=null&&i.hasError("required")?6:-1)}}var V=class e{constructor(t,i,a,c,p){this.fb=t;this.genericService=i;this.genericServiceSale=a;this.router=c;this.route=p;this.ticketForm=this.fb.group({titre:["",U.required],description:["",U.required],sale_id:["",U.required]})}ticketForm;isEditMode=!1;ticketId;titrePage="Ajouter";sales=[];baseUri=g.baseUri;ngOnInit(){this.ticketId=this.route.snapshot.params.id,this.ticketId?(this.titrePage="Modifier",this.isEditMode=!0,this.loadTickets()):this.loadSales()}loadTickets(){this.route.data.subscribe(t=>{this.sales=t.sales,this.ticketForm.patchValue({id:t.ticket.id,titre:t.ticket.titre,description:t.ticket.description,sale_id:t.ticket.sales[0].id})})}loadSales(){this.route.data.subscribe(t=>{this.sales=t.sales})}onSubmit(){if(this.ticketForm.valid){let t=this.ticketForm.value;(this.isEditMode&&this.ticketId?this.genericService.update(`${this.baseUri}/api/ticket`,this.ticketId,t):this.genericService.create(`${this.baseUri}/api/ticket`,t)).subscribe(()=>{this.router.navigate(["/ticket"]).then()})}}goBack(){this.router.navigate(["/ticket"]).then()}static \u0275fac=function(i){return new(i||e)(l(Ft),l(k),l(k),l(w),l(x))};static \u0275cmp=T({type:e,selectors:[["app-ticket-form"]],decls:24,vars:7,consts:[["autosize","cdkTextareaAutosize"],["mat-raised-button","","color","primary",3,"click"],[1,"container"],[3,"ngSubmit","formGroup"],["matInput","","formControlName","titre","type","titre"],["matInput","","formControlName","description","cdkTextareaAutosize","","cdkAutosizeMinRows","5","cdkAutosizeMaxRows","5"],["appearance","outline",1,"full-width"],[1,"actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"routerLink"],["formControlName","sale_id"],[3,"value"]],template:function(i,a){if(i&1){let c=R();r(0,"mat-card-actions")(1,"button",1),d("click",function(){return v(c),_(a.goBack())}),n(2,"Retour"),o()(),r(3,"div",2)(4,"h2"),n(5),o(),r(6,"form",3),d("ngSubmit",function(){return v(c),_(a.onSubmit())}),r(7,"mat-form-field")(8,"mat-label"),n(9,"Titre"),o(),h(10,"input",4),o(),h(11,"br"),r(12,"mat-form-field")(13,"mat-label"),n(14,"Description"),o(),h(15,"textarea",5,0),o(),h(17,"br"),s(18,he,7,1,"mat-form-field",6),r(19,"div",7)(20,"button",8),n(21),o(),r(22,"button",9),n(23,"Annuler"),o()()()()}i&2&&(m(5),u("",a.titrePage," un ticket"),m(),f("formGroup",a.ticketForm),m(12),D(a.sales?18:-1),m(2),f("disabled",!a.ticketForm.valid),m(),u(" ",a.titrePage," "),m(),f("routerLink",P(6,fe)))},dependencies:[At,It,wt,Et,yt,Dt,Rt,st,lt,y,E,$,q,jt,B,xt,Nt,Gt,Vt,Bt,Ut,J,Q],encapsulation:2})};function Ce(e,t){if(e&1&&(r(0,"div",1)(1,"h2"),n(2,"Ticket Details"),o(),r(3,"mat-card",2)(4,"mat-card-content")(5,"p")(6,"strong"),n(7,"Titre "),o(),n(8),o(),r(9,"p")(10,"strong"),n(11,"Description "),o(),n(12),o(),r(13,"p")(14,"strong"),n(15,"Vente "),o(),n(16),o()()()()),e&2){let i=C();m(8),u(" ",i.ticket.titre,""),m(4),u(" ",i.ticket.description,""),m(4),u(" ",i.ticket.sales[0].titre,"")}}var X=class e{constructor(t,i){this.route=t;this.router=i}ticket;ngOnInit(){this.route.data.subscribe(t=>{this.ticket=t.ticket})}goBack(){this.router.navigate(["/ticket"]).then()}static \u0275fac=function(i){return new(i||e)(l(x),l(w))};static \u0275cmp=T({type:e,selectors:[["app-ticket-show"]],decls:4,vars:1,consts:[["mat-raised-button","","color","primary",3,"click"],[1,"container"],[1,"ticket-card"]],template:function(i,a){i&1&&(r(0,"mat-card-actions")(1,"button",0),d("click",function(){return a.goBack()}),n(2,"Retour"),o()(),s(3,Ce,17,3,"div",1)),i&2&&(m(3),D(a.ticket?3:-1))},dependencies:[J,Ht,Q,qt,y,E],styles:[".container[_ngcontent-%COMP%]{padding:20px}.ticket-card[_ngcontent-%COMP%]{max-width:400px;margin:20px 0}p[_ngcontent-%COMP%]{margin:10px 0}mat-card-actions[_ngcontent-%COMP%]{padding:0 16px 16px}button[_ngcontent-%COMP%]{margin-right:10px}"]})};var ge=[{path:"",component:K,resolve:{tickets:W}},{path:"add",component:V,resolve:{sales:it}},{path:"edit/:id",component:V,resolve:{ticket:A,sales:it}},{path:"show/:id",component:X,resolve:{ticket:A}}],Wt=class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=nt({type:e});static \u0275inj=rt({imports:[et.forChild(ge),et]})};export{Wt as TicketingRoutingModule};
